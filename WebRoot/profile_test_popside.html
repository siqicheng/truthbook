<!DOCTYPE html>
<html lang="en">
<head>
   	<meta charset="utf-8">
   	<title>个人主页 | Truthbook</title>

   	<link href="./assets/semantic/css/semantic.css" rel="stylesheet">
   	<link href="./assets/magnific-popup/magnific-popup.css" rel="stylesheet">
   	<link href="./CSS/position.css" rel="stylesheet">
   	<link href="./CSS/addpicBtn.css" rel="stylesheet">
   	<link href="./CSS/menuBar.css" rel="stylesheet">
   	<link href="./CSS/eventSegment.css" rel="stylesheet">
   	<link href="./CSS/profileSegment.css" rel="stylesheet">
   	<link rel="shortcut icon" href="img/logo_red.ico" />
</head>
	
<body style="background-color:#DEDCDE;margin:0px;">

	<div class="ui fixed small menu" id="topbar" >
		<div class="left menu">
			<div class="ui dropdown item" id="upload_menu">
				<i class="add icon"></i> 上传照片（sidebar）
				<div class="menu">
					<a class="item" id="upload_for_new_btn">新建好友档案</a>
					<a class="item" id="upload_for_fri_btn">为已有好友上传</a>
 				</div>
			</div>
			<a class="item" id="close_sidebar_btn" style="display:none">
				<i class="remove icon"></i> 关闭 </a>
		</div>		
		<div class="title item">
	        <img src="img/Truthbook_red.png" width="140px" >
	    </div>		      
		<a class="active green item">
			<i class="home  icon"></i>
		</a>
		<a class="blue item">
	    	<i class="users icon"></i>
		</a>
		<a class="orange item">
	    	<i class="setting icon"></i>
		</a>
		<!-- a class="item" id="uploadPic">上传照片（PopUp）</a>
		<a class='open-popup-link item' id='uploadFriend' href="./uploadpic.html">已经是好友？</a -->
		<a class="open-popup-link item" href="#upload">上传照片（PopUp）</a>
<!-- 		<a class="open-popup-link item" id="open-popup-link">上传照片（PopUp）</a> -->
<!-- 		<div id="uploadpopup" class="white-popup ui modal"> -->
		<div id="upload" class="mfp-hide" >
				<div class="ui steps">
    				<div class="ui active step step1" >
    					选人
    				</div>
    				<div class="ui disabled step step2">
    					选照片
    				</div>
    				<div class="ui disabled step step3" >
    					完成
    				</div>
    			</div>
    			
    			<div class="ui divider"></div>
    			
    			<div class="ui form" >
    				<div class="ui field" id="fullNameTest">
	                    <label>姓名</label>
	                    <div class="ui left labeled icon input">
	                        <input type="text" id="fullName" placeholder="姓名" name="fullName">
	                        <i class="user icon"></i>
	                    </div>
	                </div>
    				<div class="ui field" id="schoolTest">
    					<label>学校</label>
	                    <div class="ui left labeled icon input">
	                        <input type="text" id="school" placeholder="学校： 复旦大学/北京大学" name="school">
	                        <i class="book icon"></i>
	                    </div>
	                </div>
    				<div class="ui field" id="entryTimeTest">
    					<label>入学年份</label>
	                    <div class="ui left labeled icon input">
	                        <input type="text" id="entryTime" placeholder="入学年份： 2008/2012/..." name="entryTime">
	                        <i class="align justify icon"></i>
	                    </div>
	                </div>
	                <div class="ui error message"></div>
    				<div class="ui divider"></div>
  					<input class="ui green button nextstep nextstep1"  value="下一步" readonly>
  				</div>
  				
  				<form class="ui form choosepicform" style="display:none">
	    			<div class="ui field">
	    				<label>照片描述</label>
	    				<textarea></textarea>
	    			</div>
	    			
  					<div class="ui divider"></div>
  					
  					<img id="img_prev" src="" alt="your image" ><br>
  					<div class="addpicbuttons"><a href="javascript:;" class="addpic">
  					<input type ="file" id="fileElem"  onchange="readURL(this);">选择图片</a>
  					<input class="ui green button nextstep nextstep2"  value="下一步" readonly> </div>
  				</form>
  				
  				<form class="ui form confirmform" style="display:none">
  					<div class="ui message">你将传给XXX的是下面这张图片：</div>
  					<div class="ui items">
	  					<div class="item">
	  						<div class="image">
	  							<img src="./img/profile_test/247146.jpg">
	  						</div>
	  						<div class="content">
	  							<div class="name">
	  								图片预览
	  							</div>
	  							<p class="description">图片描述</p>
	  						</div>
	  					</div>
  					</div>
  					<div class="ui divider"></div>
  					<input class="ui green button" id="submitBtn"  value="确定上传" readonly>
  				</form>
  				
  				<form class="ui form rechooseform" style="display:none">
					<div class="ui message">
						我们找到了好多XXX：
					</div>
  					<div class="ui selection list">
  						<div class="ui item segment item0" onclick="clickppitem(0)">
	  						<a class="ui corner green label" style="display:none">
	  							<i class="checkmark small icon"></i>
	  						</a>
  							<img class="ui avatar image" src="./img/profile_test/247142.jpg"> 
  							<div class="content">
	  							<div class="header">Snickerdoodle</div>
	  								An excellent companion
	  						</div>
  						</div>
					  <div class="ui item segment item1" onclick="clickppitem(1)">
  						<a class="ui corner green label" style="display:none">
  							<i class="checkmark small icon"></i>
  						</a>
					    <img class="ui avatar image" src="./img/profile_test/247142.jpg">
					    <div class="content">
					      <div class="header">Poodle</div>
					      A poodle, its pretty basic
					    </div>
					  </div>
					  <div class="ui item segment item2" onclick="clickppitem(2)">
  						<a class="ui corner green label" style="display:none">
  							<i class="checkmark small icon"></i>
  						</a>
					    <img class="ui avatar image" src="./img/profile_test/247142.jpg">
					    <div class="content">
					      <div class="header">Paulo</div>
					      He's also a dog
					    </div>
					  </div>
					  <div class="ui item segment item3" onclick="clickppitem(3)">
  						<a class="ui corner green label"  style="display:none">
  							<i class="checkmark small icon"></i>
  						</a>
					  	<img class="ui avatar image" src="./img/profile_test/247140.jpg">
					  	<div class="content">
					  		<div class="header">新建词条</div>
					  		.........
					  	</div>
					  </div>
					</div>
					<div class="ui red bottom attached message segment rechooseerror" style="display:none">请选择要发给的对象</div>
					<div class="ui divider"></div>
  					<input class="ui green button nextstep3" value="下一步" readonly>
  				</form>
		</div>
		
		<div class="right menu"  >
				<div class="item">
     				<div class="ui icon input">
       				<input type="text" placeholder="Search...">
       				<i class="search link icon"></i>
     				</div>
   			</div>
 			</div>
	</div>

	<div id="profile-segment">
		<div class="ui stacked raised segment" style="height:300px;">
			<div class="ui circular segment"></div>
		</div>
	</div>

	<div class="ui basic segment" id="menubar" >
		<div class="ui four column grid" >
			<div class="column">
				<div class="ui red inverted fluid menu" >
					<div class="ui dropdown fluid item" >
						<i class="star small icon"></i> 极·友
						<div class="ui small label">1</div>
						<div class="ui list menu">
     						<div class="item">
     							<div class="right floated">
     								<a href="./test.html"><i class="cloud upload large icon"></i></a>
     								<a href="./test.html"><i class="ban circle large icon"></i></a>     								
     							</div>
     							<img class="ui avatar image" src="./img/profile_test/247142.jpg"> 
     							<a class="content" href="./test.html">张三</a>
     						</div>
     						<a class="item">李四</a>
     						<a class="item">王五</a>
     					</div>
   					</div>
				</div>
 			</div>
			<div class="column">
				<div class="ui red inverted fluid menu">
					<div class="ui dropdown fluid item">
						<i class="half empty star small icon"></i> 真·友
						<div class="ui small label" style="float:right">12</div>
						<div class="menu">
     						<a class="item">张三</a>
     						<a class="item">李四</a>
     						<a class="item">王五</a>
   						</div>
   					</div>
				</div>
			</div>
			<div class="column">
				<div class="ui red inverted fluid menu">
					<div class="ui dropdown fluid item">
						<i class="users small icon"></i> 最近来访
						<div class="ui small label" style="float:right">3</div>
						<div class="menu">
     						<a class="item">张三</a>
     						<a class="item">李四</a>
     						<a class="item">王五</a>
   						</div>
   					</div>
				</div>
			</div>
			<div class="column">
				<div class="ui red inverted fluid menu"> 						
					<div class="ui dropdown fluid item">
						<i class="mail small icon"></i> 消息通知
						<div class="floating ui circular green label">05</div>
						<div class="menu">
     						<a class="item">您有一条新的好友请求</a>
     						<a class="item">张三为您上传了一张照片</a>
     						<a class="item">5条新评论</a>
   						</div>
   					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="ui three items" id="eventsegment">
		<div class="item">
			<div class="image" id="testimg">
		 		<img src="http://lorempixel.com/319/496/">
		 		<a><i class="heart empty icon"></i></a>
			</div>
			<div class="content" >				
				<p class="description">This dog has some things going for it. Its pretty cute and looks like it'd be fun to cuddle up with.</p>
				<div class="meta">2 days ago</div>
			</div>
			
			<div class="ui divider"></div>
			<div class="ui minimal comments">
	            <div class="comment">
	                <a class="avatar">
	                    <img src="./img/profile_test/247142.jpg">
	                </a>
	                <div class="content">
	                    <a class="author">张三</a>
	                    <div class="metadata">
	                        <span class="date">2天前</span>
	                    </div>
	                    <div class="text">
	                        最喜欢宫城良田了！！！
	                    </div>
	                </div>
	            </div>
	            <div class="comment">
	                <a class="avatar">
	                    <img src="./img/profile_test/247144.jpg">
	                </a>
	                <div class="content">
	                    <a class="author">李四</a>
	                    <div class="metadata">
	                        <span class="date">2天前</span>
	                    </div>
	                    <div class="text">
	                        图片不错！
	                    </div>
	                </div>
	            </div>
				<form class="ui reply form" style="display:none;">
					<div class="field">
					    <textarea placeholder="添加评论..."></textarea>
					</div>
					<div class="ui small teal button">
					    添加评论
					</div>
				</form>              				
			</div>
		   	<div class="extra">
		   		199 votes
		   	</div>
		</div>

		<div class="item">
			<div class="image" id="testimg2">
		  		<img src="http://lorempixel.com/319/596/">
			</div>
		    <div class="content">
		    	<div class="meta">5 days ago</div>
		      	<div class="name">Faithful Dog</div>
		      	<p class="description">Sometimes its more important to have a dog you know you can trust. But not every dog is trustworthy, you can tell by looking at its smile.</p>
		    </div>
	    	<div class="extra">
	        	311 votes
	    	</div>
	    </div>

	  	<div class="item">
	  		<div class="image">
		  		<img src="http://lorempixel.com/319/396/">
			</div>
	    	<div class="content">
	      		<div class="meta">1 week ago</div>
	      		<div class="name">Silly Dog</div>
	      		<p class="description">Silly dogs can be quite fun to have as companions. You never know what kind of ridiculous thing they will do.</p>
	    	</div>
	    	<div class="extra">
	        	522 votes
	    	</div>
	  	</div>

	  	<div class="item">
	  		<div class="image">
		  		<img src="http://lorempixel.com/319/480/">
		  	</div>
	    	<div class="content">
	      		<div class="meta">1 week ago</div>
	      		<div class="name">Silly Dog</div>
	      		<p class="description">Silly dogs can be quite fun to have as companions. You never know what kind of ridiculous thing they will do.</p>
	    	</div>
	    	<div class="extra">
	        	522 votes
	    	</div>
	  	</div>

	  	<div class="item">
	  		<div class="image">
		  		<img src="http://lorempixel.com/319/196/">
		  	</div>
	    	<div class="content">
			    <div class="meta">1 week ago</div>
			    <div class="name">Silly Dog</div>
			    <p class="description">Silly dogs can be quite fun to have as companions. You never know what kind of ridiculous thing they will do.</p>
			</div>
	    	<div class="extra">
	        	522 votes
	    	</div>
	  	</div>

	  	<div class="item">
	  		<div class="image">
		  		<img src="http://lorempixel.com/319/296/">
			</div>
	    	<div class="content">
	      		<div class="meta">1 week ago</div>
	      		<div class="name">Silly Dog</div>
	      		<p class="description">Silly dogs can be quite fun to have as companions. You never know what kind of ridiculous thing they will do.</p>
	    	</div>
	   		<div class="extra">
	        	522 votes
	    	</div>
	  	</div>	  	   
	</div>

<!-- 	<div class="ui very wide styled sidebar" id="upload_new_sidebar"> -->
<!-- 		<form class="ui form" id="uploadform"> -->
<!--    			<div class="ui field"> -->
<!--      				<label>姓名</label> -->
<!--      				<input type="text" placeholder="姓名"> -->
<!--    			</div> -->
<!--    			<div class="ui field"> -->
<!--      				<label>年级</label> -->
<!--      				<input type="text" placeholder="年级"> -->
<!--    			</div> -->
<!--    			<div class="ui field"> -->
<!--      				<label>学校</label> -->
<!--      				<input type="text" placeholder="学校"> -->
<!--    			</div> -->
  			
<!--   			<div class="ui field"><label>照片描述</label><textarea></textarea></div> -->
<!--   			<img id="img_prev" src="" alt="your image" width="300px"><br> -->
<!--   			<div class="addpicbuttons"> -->
<!--   				<a href="javascript:;" class="addpic"> -->
<!--   					<input type ="file" id="fileElem"  onchange="readURL(this);">选择图片</a>  			 -->
<!--   				<button class="ui green disabled button" id="submitBtn"> 确定上传</button> -->
<!--   			</div> -->
<!--   		</form> -->
<!-- 	</div> -->
	
	<script src="./assets/jquery/jquery-1.7.2.js"></script>
	<script src="./assets/semantic/javascript/semantic.js"></script>
	<script src="./assets/masonry.pkgd.min.js"></script>
	<script src="./assets/imagesloaded.pkgd.min.js"></script>
	<script src="./assets/magnific-popup/magnific-popup.js"></script>
	<script src="./js/general/utility.js"></script>

	<script src="./js/uploadpopup.js"></script>
	<script src="./js/sidebar_toggle.js"></script>

	<script type="text/javascript">
	$(document).ready(function() {
			//masonry initialization
		var $container=$("#eventsegment").masonry({
			itemSelector: '.item'
			});
		$container.imagesLoaded( function() {
  			$container.masonry();
			});
			//semantic dropdown intialization
		$('.ui.dropdown')
 				.dropdown(
 					{on: 'click'
 					}
 				);
 			//buttons on images show function test
		$("#testimg").hover(function(){
			    $(this).children("a").fadeIn("fast");
			    $(this).children("img").fadeTo("fast",0.9);
 				},
 				function(){
			    $(this).children("a").fadeOut("fast");
			    $(this).children("img").fadeTo("fast",1);
				}
			); 				
 			//遍历所有图片元素后为它们加上magnificPopup插件的初始化选项
		$num_items = $("#eventsegment").find(".image").children("img");
  			for(var i=0, len=$num_items.length;i< len;i++){
 	  			$($num_items[i]).magnificPopup({
   				items: {
     					src:  $($num_items[i]).attr("src")
   				},
   				type: 'image'
			}); 
 			};		
	});
	</script>


	<script>
    	$(function() {
    		$(".step1").click(function() {
    			if(($(".rechooseform").css("display")=="none") && ($(".chooseppform").css("display")=="none") ){
	    			$(".step1").attr("class","ui active step step1");
	    			$(".step2").attr("class","ui disabled step step2");
	    			$(".step3").attr("class","ui disabled step step3");
	    			$(".chooseppform").show();
	    			$(".choosepicform").hide();
	    			$(".confirmform").hide();
	    			$(".rechooseform").hide();
    			}
    		});
    		$(".step2").click(function() {
    			if($(".step2").attr("class") != "ui disabled step step2") {
    				$(".step1").attr("class","ui step step1");
    				$(".step2").attr("class","ui active step step2");
    				$(".step3").attr("class","ui disabled step step3");
    				$(".chooseppform").hide();
    				$(".choosepicform").show();
    				$(".confirmform").hide();
    				$(".rechooseform").hide();
    			}
    		});
    		$(".ui.form.chooseppform").form(
    		{
    			username:{
	    			identifier : "fullName",
	    			rules: [
		    			{
		    				type: "empty",
		    				prompt: "请输入对方姓名"
		    			}
	    			]
    			},
    			school:{
    				identifier : "school",
    				rules: [
    					{
    						type: "empty",
    						prompt: "请输入对方学校"
    					}
    				]
    			},
    			entryyear:{
    				identifier : "entryTime",
    				rules: [
    					{
    						type: "isYear",
    						prompt: "请输入正确的年份"
    					},
    					{
    						type: "earlyYear[1976]",
    						prompt: "对方那么早就入学了？"
    					},
    					{
    						type: "lateYear[2015]",
    						prompt: "今年才2014年吧？"
    					}
    				]
    			}
    		},
    		{
    			on: "blur"
    		}
    		);
    		
    		$(".nextstep1").click(function() {
//     			var isValidForm = $(".chooseppform").form("validate form");
//     			if(isValidForm == true) {
					var url = "http://localhost:8080/truthbook/dummy/false.html";
		 			var data = $(".chooseppform").serialize();
					var onAjaxSuccess = function(data,textStatus) {
						if(data == "true") {
							$(".chooseppform").hide();
		    				$(".choosepicform").show();
		    				$(".step1").attr("class","ui step step1");
		    				$(".step2").attr("class","ui active step step2");
						} else if(data == "false") {
							// 创建新人
							$(".chooseppform").hide();
							$(".rechooseform").show();
						} else if(data == 2) {
							//重名选人
						};
					};
					var onAjaxError = function(xhr,status,error){
							console.log("Register failed with error:" + error);
							return false;
					};
					var ajax_obj = getAjaxObj(url,"GET","text",onAjaxSuccess,onAjaxError);
		 			ajax_obj.data = data;
					ajax_call(ajax_obj);
// 				}
			});
    		$(".nextstep2").click(function() {
    			var url = "http://localhost:8080/truthbook/dummy/true.html";
	 			var data = $(".choosepicform").serialize();
				var onAjaxSuccess = function(data,textStatus) {
					if(data == "true") {
						$(".choosepicform").hide();
		    			$(".confirmform").show();
		    			$(".step2").attr("class","ui step step2");
		    			$(".step3").attr("class","ui active step step3");
					} else {
						//图片不符合要求
					}
				};
				var onAjaxError = function(xhr,status,error){
						console.log("Register failed with error:" + error);
						return false;
				};
				var ajax_obj = getAjaxObj(url,"GET","text",onAjaxSuccess,onAjaxError);
	 			ajax_obj.data = data;
				ajax_call(ajax_obj);
    		});
    		$(".nextstep3").click(function() {
    			if(typeof(selected_num)!="undefined") {
	    			$(".rechooseform").hide();
	    			$(".choosepicform").show();
	    			$(".step1").attr("class","ui step step1");
	    			$(".step2").attr("class","ui active step step2");
    			} else {
    				$(".rechooseerror").show();
    			}
    		});
    	});
    	
    	function clickppitem(num) {
    		if(typeof(selected_num)=="undefined") {
    			selected_num=num;
    			$(".item"+selected_num+" .label").show();
    		} else {
    			$(".item"+selected_num+" .label").hide();
    			selected_num=num;
    			$(".item"+selected_num+" .label").show();
    		};
    		$(".rechooseerror").hide();
    	};
    </script>

	<script type="text/javascript">
	//buttons on friends' list
		$(".ui.list.menu .item").hover(function(){
			$(this).children(".right.floated").fadeIn();},
			function(){
			$(this).children(".right.floated").fadeOut();}
		);
	</script>

	<script type="text/javascript">
 		$(".ui.minimal.comments").click(function(){
				$(this).children(".ui.reply.form").show();
				$("#eventsegment").masonry();
			}
		);
	</script>	
		
	<script>
		$(function(){
			$(".open-popup-link").click(function(){
				$("#upload").removeClass("ui very wide styled sidebar");
				$("#upload").addClass("white-popup");
				$("#upload").show();
			});
			$("#upload_for_new_btn").click(function(){
				$("#upload").removeClass("mfp-hide");
				$("#upload").addClass("ui very wide styled sidebar");
				$("#upload").sidebar("show");
			});
			$(".open-popup-link").magnificPopup({
// 				type:"inline",
// 				midClick: true,
// 				closeBtnInside: true
			});
		});
	</script>
	
	
</body>
</html>